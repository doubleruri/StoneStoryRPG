// Variable
// 基板 CDPanel CDPanel_ShowTie
//
// CDPanel_ActList 每一個格子要按的按鈕
// Skill_SetfnList 每一個格子按鈕對應哪個fn
// Skill_CDTimeList 對應顯示CD時間
// Skill_CDNameList 對應要抓CD的裝備名

var CDPanel
var CDPanel_ShowTime

var CDPanel_MinMax
var CDPanel_MinMaxBtn
var strMin = ＂［-］＂
var strMax = ＂［+］＂
var minimised = false

var Text_Skill_List = ＂墮神 月牙 大錘 木棒 衝刺 閃避 骷髏 火精 以太 烈石＂
var Text_Skill_List_Width = string.Size(Text_Skill_List)
var CDPanel_MinW = 10
var CDPanel_MaxW = Text_Skill_List_Width + 4

var CDPanel_Title
var CDPanel_Title_strMin = "[CD]"
var CDPanel_Title_strMax = "［Cooling Down］"

var CDPanel_SkillList
var CDPanel_ActList = ［
Act_1,Act_2,Act_3,Act_4,Act_5,
Act_6,Act_7,Act_8,Act_9,Act_10
］

var Skill_SetfnList = ［
skill_blade, skill_bardiche,
skill_hammer, skill_quarterstaff,
skill_dash, skill_mind,
skill_skeleton_arm, skill_fire_talisman,
skill_aether_talisman, skill_aether_talisman,
skill_fissure
］

var Skill_CDTimeList = ［
CDPanel_CD_1,CDPanel_CD_2,
CDPanel_CD_3,CDPanel_CD_4,
CDPanel_CD_5,CDPanel_CD_6,
CDPanel_CD_7,CDPanel_CD_8,
CDPanel_CD_9,CDPanel_CD_10,
］

var Skill_CDNameList = ［
＂blade＂, ＂bardiche＂,
＂hammer＂, ＂quarterstaff＂,
＂dash＂, ＂mind＂,
＂skeleton_arm＂, ＂fire_talisman＂,
＂aether_talisman＂, ＂fissure＂
］

var Tick_UpdateCD = 3

// function
func Build_CoolingDown_Bar()
  CDPanel = MakePanel
^(10,2,Text_Skill_List_Width + 4,4,#D35400,4)
  CDPanel.clip = true

  CDPanel_ShowTime = MakePanel
^(2,1,Text_Skill_List_Width,2,#D35400,0)  

  CDPanel_MinMaxBtn = MakeButton
^(11,2,3,1,null,null,#000000,1,MinMax_CDPanel)
  
  CDPanel_MinMax = MakeText
^(11,2,3,1,#9FE2BF,L)
  CDPanel_MinMax.text = strMin

  CDPanel_Title = MakeText
^(14,2,14,1,#880000,L)
  CDPanel_Title.text = CDPanel_Title_strMax
  CDPanel_SkillList = MakeText
^(0,0,Text_Skill_List_Width,1,#white,L)
  CDPanel_SkillList.text = Text_Skill_List

  // for loop : 做 每 一 個 CD 的 格 子 所 需  
  var xn = 0
  for i = 0..CDPanel_ActList.Count() -1
    CDPanel_ActList［i］ = MakeButton
^(xn,0,2,2,null,null,#ABB2B9,1,
^Skill_SetfnList［i］)
    Skill_CDTimeList［i］ = MakeText
^(xn,1,2,1,null,R)
    CDPanel_ShowTime.Add(CDPanel_ActList［i］)
    CDPanel_ShowTime.Add(Skill_CDTimeList［i］)
    xn = xn + 3

  CDPanel.Add(CDPanel_ShowTime)
  CDPanel_ShowTime.Add(CDPanel_SkillList)

//  左上放大縮小作用
func MinMax_CDPanel()
    // 切 換true/false
    // 根 據 true/false 決 定 要 不 要 隱 藏
  minimised = !minimised
  ?minimised = false
    CDPanel.visible = true
    CDPanel_MinMax.text = strMin
    CDPanel_Title.text = CDPanel_Title_strMax
  ?minimised = true
   CDPanel.visible = false
    CDPanel_MinMax.text = strMax
    CDPanel_Title.text = CDPanel_Title_strMin

// 技 能 施 放 function
func skill_blade()
  ?item.GetCooldown(＂blade＂) <= 0
    equip blade
    activate R
 //
func skill_bardiche()
  ?item.GetCooldown(＂bardiche＂) <= 0
^& item.CanActivate()
    equip bardiche
    activate R
 //
func skill_hammer()
  ?item.GetCooldown(＂hammer＂) <= 0
    equip Heavy Hammer
    activate R
 //
func skill_quarterstaff()
  ?item.GetCooldown(＂quarterstaff＂) <= 0
    equip quarterstaff
    activate R
 //
func skill_dash()
  ?item.GetCooldown(＂dash＂) <= 0
    equipR dash
 //
func skill_mind()
  ?item.GetCooldown(＂mind＂) <= 0
    equipR mind
 //
func skill_skeleton_arm()
  ?item.GetCooldown(＂skeleton_arm＂) <= 0
    equip skeleton_arm
    activate R
 //
func skill_fire_talisman()
  ?item.GetCooldown(＂fire_talisman＂) <= 0
^& summon.GetId() ! ＂cinderwisp＂
    equipR fire talisman
    activate R
 //
func skill_aether_talisman()
  ?item.GetCooldown(＂aether_talisman＂) <= 0
    equipR aether talisman
    activate R
 //
func skill_fissure_stone()
  ?item.GetCooldown(＂aether_talisman＂) <= 0
    equipR fissure stone

//  每 0.1 秒 更 新 冷 卻 時 間(3frame)
func Update_CDTime()
  Tick_UpdateCD--
  ?Tick_UpdateCD = 0
    Tick_UpdateCD = 3
    for i = 0..Skill_CDNameList.Count()-1
      Skill_CDTimeList［i］.text =
^item.GetCooldown(Skill_CDNameList［i］)/30 + ＂＂


// Run Script Befor Stage Start

?loc.begin | loc.loop
  Build_Tools()
  Build_CoolingDown_Bar()

// Looping Here
Update_CDTime()
